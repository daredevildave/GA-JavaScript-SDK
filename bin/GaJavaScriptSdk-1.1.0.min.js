var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var f=CryptoJS,g=f.lib,h=g.WordArray,i=g.Hasher,g=f.algo,j=[],k=0;64>k;k++)j[k]=4294967296*a.abs(a.sin(k+1))|0;g=g.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),f.MD5=i._createHelper(g),f.HmacMD5=i._createHmacHelper(g)}(Math);var GameAnalytics=function(){function a(){this.sessionId=GAUniqueidUtil.createUniqueId(),this.apiUrl=window.location.protocol+"//api.gameanalytics.com/1/",this.messageQueue=new MessageQueue}return a.getInstance=function(){return null===a.instance&&(a.instance=new a),a.instance},a.prototype.init=function(b,c,d,e){if(null===a.instance)throw new Error("No instance available!");this.gameKey=b,this.secretKey=c,this.build=d,this.userId=e,this.sendEvent(new UserEvent(GADeviceUtil.createUserEventDeviceObject(a.SDK_VERSION)))},a.prototype.addEvent=function(b){if(null===a.instance)throw new Error("No instance available!");var c=new Message(b,this.userId,this.sessionId,this.build);this.messageQueue.push(c)},a.prototype.sendEvent=function(b){if(null===a.instance)throw new Error("No instance available!");var c=new Message(b,this.userId,this.sessionId,this.build),d="";try{d=JSON.stringify(c.data)}catch(b){}this.send(d,c.event)},a.prototype.sendData=function(){var b=this;if(null===a.instance)throw new Error("No instance available!");[GameAnalyticsEvent.BUSINESS_EVENT,GameAnalyticsEvent.DESIGN_EVENT,GameAnalyticsEvent.ERROR_EVENT].forEach(function(a){for(var c=[],d="";b.messageQueue.length(a)>0;){var e=b.messageQueue.pop(a);c.push(e.data)}if(0!==c.length){try{d=JSON.stringify(c)}catch(f){}b.send(d,a)}})},a.prototype.send=function(b,c){if(null===a.instance&&null===this.gameKey)throw new Error("No instance available!");if(!(b.length<1)){var d=CryptoJS.MD5(b+this.secretKey),e=CryptoJS.enc.Hex.stringify(d),f=this.apiUrl+this.gameKey+"/"+c;GARequest.post(f,b,e,function(a){a.success===!1&&window.console&&console.log(a.message)})}},a.SDK_VERSION="Javascript 1.1.0",a.instance=null,a}(),MessageQueue=function(){function a(){this.designQueue=[],this.businessQueue=[],this.errorQueue=[],this.userQueue=[],this.load()}return a.prototype.push=function(a){var b=this.getQueue(a.event);b.push(a),this.save(a.event)},a.prototype.pop=function(a){var b=this.getQueue(a),c=b.pop();return this.save(c.event),c},a.prototype.length=function(a){var b=this.getQueue(a);return b.length},a.prototype.getQueue=function(a){switch(a){case GameAnalyticsEvent.BUSINESS_EVENT:return this.businessQueue;case GameAnalyticsEvent.ERROR_EVENT:return this.errorQueue;case GameAnalyticsEvent.USER_EVENT:return this.userQueue;case GameAnalyticsEvent.DESIGN_EVENT:default:return this.designQueue}},a.prototype.load=function(){},a.prototype.save=function(a){switch(a){case GameAnalyticsEvent.BUSINESS_EVENT:case GameAnalyticsEvent.DESIGN_EVENT:case GameAnalyticsEvent.USER_EVENT:case GameAnalyticsEvent.ERROR_EVENT:}},a}(),Message=function(){function a(a,b,c,d){this.e=a,this.userId=b,this.sessionId=c,this.build=d}return a.fromString=function(b,c){try{var d=JSON.parse(c),e=new GeneralEvent(b,d.eventId,d.value,d.area,d.x,d.y,d.z);return new a(e,d.userId,d.sessionId,d.build)}catch(e){}return null},Object.defineProperty(a.prototype,"data",{get:function(){var a={user_id:this.userId,session_id:this.sessionId,build:this.build},b=this.e.getData();for(var c in b)b.hasOwnProperty(c)&&null!==b[c]&&(a[c]=b[c]);return a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"event",{get:function(){return this.e.event},enumerable:!0,configurable:!0}),a}(),GAUniqueidUtil=function(){function a(){}return a.createUniqueId=function(){for(var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",b=a.length-1,c="",d=0;35>d;d++)c+=8==d||13==d||18==d||23==d?"-":a.charAt(Math.floor(Math.random()*b));return c},a}(),GARequest=function(){function a(){}return a.post=function(a,b,c,d){var e;if(!window.XMLHttpRequest)return void d({success:!1,message:"Error: Unable to send request, XMLHttpRequest not supported"});e=new XMLHttpRequest,e.onreadystatechange=function(){200===e.status?d({success:!0,message:"Success: "+e.responseText}):e.status>0&&d({success:!1,message:"Error: There was a problem with the request: status "+e.status})};try{e.open("POST",a,!0),e.setRequestHeader("Authorization",c),e.setRequestHeader("Content-Type","text/plain"),e.send(b)}catch(f){d({success:!1,message:"Error: Unable to send request, CORS not allowed."})}},a}(),GADeviceUtil=function(){function a(){}return a.createUserEventDeviceObject=function(a){var b={sdk_version:a},c=navigator.userAgent;if(c.match(/iPad|iPod|iPhone/i)){b.platform="iOS",b.device=c.match(/iPad|iPod|iPhone/i)[0];var d=c.indexOf("OS "),e=c.substr(d+3,3).replace("_",".");b.os_major="iOS "+e[0],b.os_minor="iOS "+e}else if(c.match(/Android/i)){b.platform="Android",b.device=c.match(/Mobile/i)?"Phone":"Tablet";var d=c.indexOf("Android "),e=c.substr(d+8,3);b.os_major="Android "+e[0],b.os_minor="Android "+e}else if(c.match(/Windows Phone/i)){b.platform="Windows",b.device="Windows Phone";var d=c.indexOf("Windows Phone "),e=c.substr(d+3,3);b.os_major="Windows Phone "+e[0],b.os_minor="Windows Phone "+e}return b},a}(),GameAnalyticsEvent=function(){function a(a){this.event=a}return a.prototype.getData=function(){},a.DESIGN_EVENT="design",a.BUSINESS_EVENT="business",a.ERROR_EVENT="error",a.USER_EVENT="user",a}(),__extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},GeneralEvent=function(a){function b(b,c,d,e,f,g,h){void 0===c&&(c=null),void 0===d&&(d=null),void 0===e&&(e=null),void 0===f&&(f=null),void 0===g&&(g=null),void 0===h&&(h=null),a.call(this,b),this.event=b,this.eventId=c,this.value=d,this.area=e,this.x=f,this.y=g,this.z=h}return __extends(b,a),b.prototype.getData=function(){return{event_id:this.eventId,value:this.value,area:this.area,x:this.x,y:this.y,z:this.z}},b}(GameAnalyticsEvent),DesignEvent=function(a){function b(b,c,d,e,f,g){a.call(this,GameAnalyticsEvent.DESIGN_EVENT,b,c,d,e,f,g)}return __extends(b,a),b}(GeneralEvent),GaErrorEvent=function(a){function b(b,c,d,e,f,g){a.call(this,GameAnalyticsEvent.ERROR_EVENT,b,c,d,e,f,g)}return __extends(b,a),b}(GeneralEvent),UserEvent=function(a){function b(b){a.call(this,GameAnalyticsEvent.USER_EVENT),this.userData=b}return __extends(b,a),b.prototype.getData=function(){return this.userData},b}(GameAnalyticsEvent),BusinessEvent=function(a){function b(b,c,d,e,f,g){a.call(this,GameAnalyticsEvent.BUSINESS_EVENT,b,c,d,e,f,g)}return __extends(b,a),b}(GeneralEvent);